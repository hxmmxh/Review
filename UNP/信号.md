# 信号

* [信号基本概念](#信号基本概念)
* [发送信号](#发送信号)
* [处理信号](#处理信号)







## 信号基本概念

* 信号是软件终端，提供了一种处理异步事件的方法
* 信号的名字都以SIG开头，在头文件<signal.h>中被定义为正整数常量

### 信号的产生情况

* 终端产生信号，例如Ctrl+c会产生中断信号SIGINT
* 硬件异常产生信号，例如除数为0，无效的内存引用
* 进程调用kill函数可将任意信号发送给另一个进程或进程组，接收信号进程和发送信号进程的所有者必须相同，或发送信号进程的所有者必须是超级用户
* 用户可用kill命令将信号发送给其他进程
* 当检测到某种软件条件发生，并应将其通知给有关进程时也会产生信号，例如SIGPIPE，在管道的读进程终止后，一个进程写此管道会产生

### 信号的处理方式

* 忽略信号。除了SIGKILL和SIGSTOP，向内核提供了使进程终止或停止的可靠方法，其他信号都可以被忽略
* 捕捉信号。通知内核在某种信号发生时，调用一个用户函数，在函数中对这个事件进行处理。不能捕捉SIGKILL和SIGSTOP信号。
* 执行系统默认动作

### 常见的信号

## signal函数

```c
#include <signal.h>
void (*signal(int signo, void (*func)(int)))(int);
或者简便写法
typedef void Sigfunc(int);
Sigfunc *signal (int Sigfunc *)
```

* signal函数有两个参数，返回一个函数指针，第一个参数是signo，表示信号名，第二个参数是函数指针，指向一个void(int)类型的函数。返回的函数指针也是void(int)类型。
* 当用signal设置信号处理程序时，第二个参数是指向信号处理程序的指针，返回的是之前的信号处理程序的指针
* func除了指向信号处理程序外，还可以是两个常量SIG_IGN，表示忽略此信号,以及SIG_DFL，表示采用系统默认作用




## 发送信号


## 信号集

* 用结构体sigset_t表示一个信号集
* 在使用信号集之前，需要调用sigemptyset或sigfillset一次

```c
#include <signal.h>
int sigemptyset(sigset_t *set);
//初始化由set指向的信号集，清除其中所有信号
int sigfillset(sigset_t *set);
//初始化由set指向的信号集，使其包含所有信号
int sigaddset(sigset_t *set, int signo);
//添加一个信号
int sigdelset(sigset_t *set, int signo);
//删除一个信号
//以上四个函数成功返回0，出错返回-1
int sigmember(const sigset_t *set, int signo)
//检查信号集中是否包含signo信号
//若真返回-1，假返回0
```

* 信号屏蔽字规定了当前阻塞而不能传递给该进程的信号集，可通过下面函数检测或更改




## sigaction