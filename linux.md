# 目录
* [linux基本概念]
* [linux常用指令]





[参考资料](https://www.cnblogs.com/yjd_hycf_space/p/7730690.html)

------------------------
# linux基本概念

## 文件系统
* 组成部分
    * inode：一个文件占用一个 inode，记录文件的属性，同时记录此文件的内容所在的 block 编号；
    * block：记录文件的内容，文件太大时，会占用多个 block。
    * superblock：记录文件系统的整体信息，包括 inode 和 block 的总量、使用量、剩余量，以及文件系统的格式与相关信息等；
    * block bitmap：记录 block 是否被使用的位图。
* 文件读取
    * Ext2 文件系统，当要读取一个文件的内容时，先在 inode 中查找文件内容所在的所有 block，然后把所有 block的内容读出来。
    * FAT 文件系统，它没有 inode，每个 block 中存储着下一个 block 的编号。
* 磁盘碎片
    * 指一个文件内容所在的 block 过于分散，导致磁盘磁头移动距离过大，从而降低磁盘读写性能。
    * 在 Ext2 文件系统中所支持的 block 大小有 1K，2K 及 4K 三种，不同的大小限制了单个文件和文件系统的最大大小。FAT 文件系统，它没有 inode，每个 block 中存储着下一个 block 的编号。
* inode
    * 包含信息
        * 权限 (read/write/excute)；
        * 拥有者与群组 (owner/group)；
        * 容量；
        * 建立或状态改变的时间 (ctime)；
        * 最近读取时间 (atime)；
        * 最近修改时间 (mtime)；
        * 定义文件特性的旗标 (flag)，如 SetUID...；
        * 该文件真正内容的指向 (pointer)。
    * 特点
        * 每个 inode 大小均固定为 128 bytes (新的 ext4 与 xfs 可设定到 256 bytes)；
        * 每个文件都仅会占用一个 inode。
* 目录
    * 建立一个目录时，会分配一个 inode 与至少一个 block。block 记录的内容是目录下所有文件的 inode 编号以及文件名。
    * 可以看到文件的 inode 本身不记录文件名，文件名记录在目录中，因此新增文件、删除文件、更改文件名这些操作与目录的写权限有关。
* 硬链接和软链接
    * 硬链接(hard link)：A是B的硬链接（A和B都是文件名），则A的目录项中的inode节点号与B的目录项中的inode节点号相同，即一个inode节点对应两个不同的文件名，两个文件名指向同一个文件，A和B对文件系统来说是完全平等的。如果删除了其中一个，对另外一个没有影响。每增加一个文件名，inode节点上的链接数增加一，每删除一个对应的文件名，inode节点上的链接数减一，直到为0，inode节点和对应的数据块被回收。、
    * 软链接(soft link)：A是B的软链接（A和B都是文件名），A的目录项中的inode节点号与B的目录项中的inode节点号不相同，A和B指向的是两个不同的inode，继而指向两块不同的数据块。但是A的数据块中存放的只是B的路径名（可以根据这个找到B的目录项）。A和B之间是“主从”关系，如果B被删除了，A仍然存在（因为两个是不同的文件），但指向的是一个无效的链接。
    * 不能对目录创建硬链接；不能对不同的文件系统创建硬链接；不能对不存在的文件创建硬链接；
    * 可以对目录创建软连接；可以跨文件系统；可以对不存在的文件创建软连接；
    * 因为链接文件包含有原文件的路径信息，所以当原文件从一个目录下移到其他目录中，再访问链接文件，系统就找不到了，而硬链接就没有这个缺陷，你想怎么移就怎么移；还有它要系统分配额外的空间用于建立新的索引节点和保存原文件的路径。

## 文件
* 用户分为三种：文件拥有者、群组以及其它人，对不同的用户有不同的文件权限。
* 9 位的文件权限字段中，每 3 个为一组，共 3 组，每一组分别代表对文件拥有者、所属群组以及其它人的文件权限。一组权限中的 3 位分别为 r、w、x 权限，表示可读、可写、可执行。
* 文件名不是存储在一个文件的内容中，而是存储在一个文件所在的目录中。因此，拥有文件的 w 权限并不能对文件名进行修改。
* 目录存储文件列表，一个目录的权限也就是对其文件列表的权限。因此，目录的 r 权限表示可以读取文件列表；w 权限表示可以修改文件列表，具体来说，就是添加删除文件，对文件名进行修改；x 权限可以让该目录成为工作目录，
* x 权限是 r 和 w 权限的基础，如果不能使一个目录成为工作目录，也就没办法读取文件列表以及对文件列表进行修改了。

---------------------------------
# linux常用指令

## 文件操作
ls 列出文件或者目录的信息，目录的信息就是其中包含的文件。
cd 更换当前目录
mkdir 创建目录
rmdir 删除目录，目录必须为空。
touch 更新文件时间或者建立新文件
cp 复制文件。如果源文件有两个以上，则目的文件一定要是目录才行。
rm 删除文件
mv 移动文件
pwd 查看当前工作目录路径

* 可以将一组权限用数字来表示，此时一组权限的 3 个位当做二进制数字的位，从左到右每个位的权值为 4、2、1，即每个权限对应的数字权值为 r : 4、w : 2、x : 1。
* 也可以使用符号来设定权限。
```
# chmod [ugoa] [+-=] [rwx] dirname/filename
- u：拥有者
- g：所属群组
- o：其他人
- a：所有人
- +：添加权限
- -：移除权限
- =：设定权限
```


cat 取得文件内容。
tac cat 的反向操作，从最后一行开始打印。
more 和 cat 不同的是它可以一页一页查看文件内容，比较适合大文件的查看。
less 和 more 类似，但是多了一个向前翻页的功能。
head 取得文件前几行。
tail 是 head 的反向操作，只是取得是后几行。
od 以字符或者十六进制的形式显示二进制文件。
## 正则表达式

### 常见通配符



* 限定符

| | |
|---|----|
|\*|匹配前面的子表达式零次或多次。例如，zo* 能匹配 "z" 以及 "zoo"。* 等价于{0,}。|
|+|匹配前面的子表达式一次或多次。例如，'zo+' 能匹配 "zo" 以及 "zoo"，但不能匹配 "z"。+ 等价于 {1,}。
|?|匹配前面的子表达式零次或一次。例如，"do(es)?" 可以匹配 "do" 、 "does" 中的 "does" 、 "doxy" 中的 "do" 。? 等价于 {0,1}。
|.|匹配除换行符 \n 之外的任何单字符。要匹配 . ，请使用 \. 。|
|{n}|n 是一个非负整数。匹配确定的 n 次。例如，'o{2}' 不能匹配 "Bob" 中的 'o'，但是能匹配 "food" 中的两个 o。
|{n,}|n 是一个非负整数。至少匹配n 次。例如，'o{2,}' 不能匹配 "Bob" 中的 'o'，但能匹配 "foooood" 中的所有 o。'o{1,}' 等价于 'o+'。'o{0,}' 则等价于 'o*'。
|{n,m}|m 和 n 均为非负整数，其中n <= m。最少匹配 n 次且最多匹配 m 次。例如，"o{1,3}" 将匹配 "fooooood" 中的前三个 o。'o{0,1}' 等价于 'o?'。请注意在逗号和两个数之间不能有空格。



* 定位符

| | |
|---|----|
|^|匹配输入字符串开始的位置。如果设置了 RegExp 对象的 Multiline 属性，^ 还会与 \n 或 \r 之后的位置匹配。
|$|匹配输入字符串结尾的位置。如果设置了 RegExp 对象的 Multiline 属性，$ 还会与 \n 或 \r 之前的位置匹配。
|\b|匹配一个单词边界，即字与空格间的位置。
|\B|非单词边界匹配。


* 不能将限定符与定位符一起使用。由于在紧靠换行或者单词边界的前面或后面不能有一个以上位置，因此不允许诸如 ^* 之类的表达式。
* 若要匹配一行文本开始处的文本，请在正则表达式的开始使用 ^ 字符。不要将 ^ 的这种用法与中括号表达式内的用法混淆。
* 若要匹配一行文本的结束处的文本，请在正则表达式的结束处使用 $ 字符。



### grep，查找
* grep (global search regular expression(RE) and print out the line,全面搜索正则表达式并把行打印出来)是一种强大的文本搜索工具，
* 使用正则表达式搜索文本，并把匹配的行打印出来。常用来在结果中搜索特定的内容。

```
$ grep [-acinv] [--color=auto] 搜寻字符串 filename
-c ： 统计个数
-i ： 忽略大小写
-n ： 输出行号
-v ： 反向选择，也就是显示出没有 搜寻字符串 内容的那一行
--color=auto ：找到的关键字加颜色显示
```

### awk，数据分析生成报告
* awk是一个强大的文本分析工具，相对于grep的查找，sed的编辑，awk在其对数据分析并生成报告时，显得尤为强大。
* 简单来说awk就是把文件(或其他方式的输入流, 如重定向输入)逐行的读入（看作一个记录集）, 把每一行看作一条记录，以空格(或\t,或用户自己指定的分隔符)为默认分隔符将每行切片（类似字段），切开的部分再进行各种分析处理。
* 完整的awk脚本通常用来格式化文本文件中的信息。通常，awk是以文件的一行为处理单位的。awk每接收文件的一行，然后执行相应的命令，来处理文本
* `$ awk '条件类型 1 {动作 1} 条件类型 2 {动作 2} ...' filename`

###  sed，编辑
sed更侧重对搜索文本的处理，如修改、删除、替换等等。sed主要用来自动编辑一个或多个文件；简化对文件的反复操作；编写转换程序等。















## top,实时查看CPU和内存使用情况

能够实时显示系统中各个进程的资源占用状况

第一行（top）：
　　15:24:36 系统当前时刻
　　14 days 系统启动后到现在的运作时间
　　3 users 当前登录到系统的用户，更确切的说是登录到用户的终端数 -- 同一个用户同一时间对系统多个终端的连接将被视为多个用户连接到系统，这里的用户数也将表现为终端的数目
　　load average 当前系统负载的平均值，后面的三个值分别为1分钟前、5分钟前、15分钟前进程的平均数，一般的可以认为这个数值超过 CPU 数目时，CPU 将比较吃力的负载当前系统所包含的进程
 
第二行（Tasks）：
　　288 total 当前系统进程总数
　　1 running 当前运行中的进程数
　　287 sleeping 当前处于等待状态中的进程数
　　0 stoped 被停止的系统进程数
　　0 zombie 僵尸进程数
 
第三行（Cpus）：
　　7.3% us 用户空间占用CPU百分比
　　2.0% sy 内核空间占用CPU百分比
　　0.0% ni 用户进程空间内改变过优先级的进程占用CPU百分比
　　90.4% id 空闲CPU百分比
　　0.3% wa 等待输入输出的CPU时间百分比
　　0.0% hi
　　0.0% si
　　0.0% st
 
第四行（Mem）：
　　2042616 total 物理内存总量
　　1770116 used 使用的物理内存总量
　　272500 free 空闲内存总量
　　163912 buffers 用作内核缓存的内存量

　　　　
第五行（Swap）：
表示类别同第四行（Mem），但此处反映着交换分区（Swap）的使用情况。通常，交换分区（Swap）被频繁使用的情况，将被视作物理内存不足而造成的。
　　2094076 total 交换区总量
　　45052 used 使用的交换区总量
　　2049024 free 空闲交换区总量
　　346624 cached 缓冲的交换区总量

　　PID：进程的ID
　　USER：进程所有者
　　PR：进程的优先级别，越小越优先被执行
　　NInice：值
　　VIRT：进程占用的虚拟内存
　　RES：进程占用的物理内存
　　SHR：进程使用的共享内存
　　S：进程的状态。S表示休眠，R表示正在运行，Z表示僵死状态，N表示该进程优先值为负数
　　%CPU：进程占用CPU的使用率
　　%MEM：进程使用的物理内存和总内存的百分比
　　TIME+：该进程启动后占用的总的CPU时间，即占用CPU使用时间的累加值。
　　COMMAND：进程启动命令名称
 
### ps，显示瞬间的进程状态
ps命令就是最基本进程查看命令。使用该命令可以确定有哪些进程正在运行和运行的状态、进程是否结束、进程有没有僵尸、哪些进程占用了过多的资源等等.总之大部分信息都是可以通过执行该命令得到。ps是显示瞬间进程的状态，并不动态连续；如果想对进程进行实时监控应该用top命令。



### free，内存状态
　　free命令可以显示当前系统未使用的和已使用的内存数目，还可以显示被内核使用的内存缓冲区。
total:总计物理内存的大小。
　　used:已使用多大。
　　free:可用有多少。
　　Shared:多个进程共享的内存总额。
　　Buffers/cached:磁盘缓存的大小。

### pmap命令
　　pmap命令用于报告进程的内存映射关系








### Linux常用网络命令 
[参考资料](https://www.cnblogs.com/klb561/p/9074278.html)

1. hostname
    * hostname 没有选项，显示主机名字
    * hostname –d 显示机器所属域名
    * hostname –f 显示完整的主机名和域名
    * hostname –i 显示当前机器的 ip 地址
    * hostname+新的主机名 命令可以临时设置主机名,比如hostname newname，可以临时修改主机名称而不用重启。而通过/etc/sysconfig/network 文件来修改主机名则需要重启才能生效。当然，我们在在执行这个命令后，必须记得手动修改/etc/sysconfig/network 文件里面的 HOSTNAME 的值，以便后续重启生效，这算是一个小技巧哦！
2. ping
    * ping 将数据包发向用户指定地址。当包被接收，目标机器发送返回数据包。ping 主要有两个作用：
        * 用来确认网络连接是畅通的。
        * 用来查看连接的速度信息。
        * 如果你 ping zhangge.net  它将返回它的 ip 地址 。你可以通过 ctrl+C 来停止命令。
        * -c 参数可以定义 ping 的次数，脚本中的网络判断用得比较多，比如 ping -c 4  zhangge.net 就是 ping 张戈博客四次；而在 windows 下，则使用-n 参数来定义 ping 次数，如 ping -n 4 zhangge.net
        * 用ICMP实现
3. ifconfig
    * 查看用户网络配置。它显示当前网络设备配置。对于需要接收或者发送数据错误查找，这个工具极为好用
4. nslookup
    * nslookup 这个命令在 有 ip 地址时，可以用这个命令来显示主机名，可以找到给定域名的所有 ip 地址。而你必须连接到互联网才能使用这个命令。
    * 你也可以使用 nslookup 从 ip 获得主机名或从主机名获得 ip。
5. traceroute
    * 可用来查看数据包在提交到远程系统或者网站时候所经过的路由器的 IP 地址、跳数和响应时间。同样你必须链接到互联网才能使用这个命令。
6. telnet
    * 通过 telnet 协议连接目标主机，如果 telnet 连接可以在任一端口上完成即代表着两台主机间的连接良好。
    * telnet hostname port – 使用指定的端口 telnet 主机名。这通常用来测试主机是否在线或者网络是否正常。
7. ethtool
    * ethtool 允许你查看和更改网卡的许多设置（不包括 Wi-Fi 网卡）。你可以管理许多高级设置，包括 tx/rx、校验及网络唤醒功能。下面是一些你可能感兴趣的基本命令：
    * ethtool -i 显示一个特定网卡的驱动信息，检查软件兼容性时尤其有用
    * ethtool -p 启动一个适配器的指定行为，比如让适配器的 LED 灯闪烁，以帮助你在多个适配器或接口中标识接口名称
    * ethtool -s 显示网络统计信息
    * ethtool speed <10|100|1000> 设置适配器的连接速度，单位是 Mbps
8. netstat
    * 发现主机连接最有用最通用的 Linux 命令。你可以使用”netstat -g”查询该主机订阅的所有多播组（网络）
    * netstat -nap | grep port 将会显示使用该端口的应用程序的进程 id
    * netstat -a or netstat –all 将会显示包括 TCP 和 UDP 的所有连接
    * netstat –tcp or netstat –t 将会显示 TCP 连接
    * netstat –udp or netstat –u 将会显示 UDP 连接
    * netstat -g 将会显示该主机订阅的所有多播网络。













 -----------------------
